"use strict";(()=>{function l(e){let t=e.split("-")[1].split("."),n=document.body;return t.forEach(o=>{n=n.children[parseInt(o)]}),n}var a="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InF2YXJsb29mcW15c3ljeWtzdHR5Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3MzIzMzYzNTEsImV4cCI6MjA0NzkxMjM1MX0.SKF5LsyqW8f3S0FZYIL3eD5VhOhlJmKyRqrAwSETYQI";async function d(){let e=window.location.hostname;e.includes("localhost")&&(e="reactiverobot.com");let t=window.location.pathname;return fetch(`https://qvarloofqmysycykstty.supabase.co/rest/v1/route_meta?domain=eq.${e}&route=eq.${t}&select=*`,{headers:{apikey:a,Authorization:`Bearer ${a}`,Range:"0-9"}}).then(n=>n.json()).catch(n=>(console.error("Error fetching route meta:",n),null))}async function s(e){try{let t=window.location.hostname;t.includes("localhost")&&(t="reactiverobot.com");let n=window.location.pathname,o=JSON.stringify({domain:t,route:n,name:e,anon_id:c()}),r=await fetch("https://qvarloofqmysycykstty.supabase.co/functions/v1/track-event",{method:"POST",mode:"cors",headers:{Authorization:`Bearer ${a}`,"Content-Type":"application/json",apikey:a},body:o});if(!r.ok)throw new Error(`HTTP error! status: ${r.status}`);return console.log(`Event ${e} for ${t}${n} for anon_id=${c()}`),r}catch(t){return t instanceof Error&&console.error("Error tracking event:",t.message),null}}function m(e){return e.map(t=>({eventName:t.eventName,element:l(t.haid)}))}function u(e){e.forEach(({eventName:t,element:n})=>{let o=n.onclick;n.onclick=async r=>{r.preventDefault(),await s(t);let i=n.href;o&&o.call(n,r),i&&(window.location.href=i)}})}window.addEventListener("load",async function(){let e=await d();e&&e.length>0&&(console.log(`Loaded route meta for ${e[0].domain}${e[0].route}`),console.log(`Annotating ${e[0].meta.length} elements`),console.debug(e[0].meta),u(m(e[0].meta)),s("page_view"))});function c(){let e="supatrack_anonymous_id",t=document.cookie.split("; ").find(o=>o.startsWith(e));if(t)return t.split("=")[1];let n=Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15);return document.cookie=`${e}=${n};max-age=${60*60*24*365};path=/`,n}})();
